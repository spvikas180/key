function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}window.h=window.h||React.createElement,window.f=window.f||React.Fragment;const tooManyViewStyle={height:"120px",minHeight:"calc(100% - 452px)",paddingTop:0},langString=a=>langMap[a]?langMap[a]:lang_string(a),formatTimeStr=a=>{let b="",c=Math.floor(a/60),d=Math.floor(a%60);return b=`${10>c?`0${c}`:c}:${10>d?`0${d}`:d}`,b};class InputRow extends React.Component{constructor(a){super(a),this.init=()=>{this.props.value?this.upload(this.props.value):this.setState({rowStatus:"nodata"})},this.focus=()=>{this.setState({rowStatus:""})},this.blur=a=>{let b=a.target.value;this.upload(b)},this.change=a=>{this.props.onChange(a)},this.upload=a=>{let b=this.props.check(a||this.props.value||"");this.setState({msg:b.msg,rowStatus:b.rowStatus})},this.state={showPassword:!1,rowStatus:"nodata",msg:""}}componentDidMount(){this.init()}componentWillReceiveProps(a){a.required||a.value||this.setState({rowStatus:"nodata",msg:""})}render(){let{rowStatus:a,msg:b,showPassword:c}=this.state,{label:d,value:e,inputName:g,inputType:i,inputId:j,required:k,showPsd:l}=this.props;return h("div",{className:"login_row_pad"},h("div",{className:["form-group","parentCls","has-feedback","login_row",a].join(" ")},h("label",{for:j,className:"login_row_text"},d),h("input",{type:l?c?"text":"password":i,className:"form-control inputElem login_row_input",name:g,id:j,value:e,"data-required":k?"1":"",autocomplete:"password"==i?"new-password":"off",onChange:a=>{this.change(a.target.value)},onBlur:a=>{this.blur(a)},onFocus:()=>{this.focus()},style:{paddingRight:"68px"}}),l&&h("span",{className:`icon icon-hide ${c?"active":""}`,onClick:()=>{this.setState({showPassword:!c})}}),h("span",{className:`icon icon-close`,style:{display:""===e?"none":"block",right:l?"38px":"11px"},onClick:()=>{this.change("");let a=this.props.check("");this.setState({msg:a.msg,rowStatus:a.rowStatus})}})),h("span",{className:"help-block"},b))}}class Button extends React.Component{constructor(a){super(a),this.focus=()=>{this.setState({rowStatus:""})},this.blur=a=>{let b=a.target.value,c=this.props.check(b);this.setState({msg:c.msg,rowStatus:c.rowStatus})},this.change=a=>{let b=a.target.value;this.props.onChange(b)},this.state={}}componentDidMount(){}render(){let{btnId:a,btnDisabled:b,btnLoading:c,btnText:d,btnClick:g,style:i}=this.props;return h("button",{type:"button",className:"btn btn-error btn-block sub-btn _green-btn",id:a,disabled:b,style:i||{},onClick:a=>{g(a)}},c?h("div",{className:"spinner",style:{display:"block"}},h("div",{className:"bounce1"}),h("div",{className:"bounce2"}),h("div",{className:"bounce3"})):h("span",null,d))}}class QRCode extends React.Component{constructor(a){super(a),this.init=a=>{let b=$(`#${this.props.id}`);b.find(".loading, canvas").remove(),a||this.props.url?b.qrcode({render:"canvas",width:this.props.width,height:this.props.height,text:a||this.props.url}):b.append(`<div class="loading" style="width: ${this.props.width||0}px;height: ${this.props.height||0}px"></div>`)},this.state={}}componentDidMount(){this.init()}componentWillReceiveProps(a){a.url!=this.props.url&&this.init(a.url)}render(){return h("div",{id:this.props.id,className:this.props.class||""})}}class LoginQRCode extends React.Component{constructor(a){super(a),this.init=()=>{this.props.initQRcode()},this.state={}}componentDidMount(){this.init()}render(){let{QRurl:a,qrCodeStatus:b,qrMsg:c}=this.props;return h("div",{style:{position:"relative",display:"flex",flex:5,flexDirection:"column",justifyContent:"center",alignItems:"center",paddingBottom:window.is_ru?"40px":"auto"}},h("div",{style:{width:"180px",height:"180px",position:"relative"}},b&&0!=b?h("div",{className:`qrStatusMask qrStatus-${b}`},3>b?h("svg",{class:"icon",style:{},viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38"},h("path",{d:"M501.76 931.84A419.84 419.84 0 11921.6 512a420.352 420.352 0 01-419.84 419.84zm0-778.24A358.4 358.4 0 10860.16 512a358.81 358.81 0 00-358.4-358.4zm-48.077 508.109l256-256a30.72 30.72 0 00-43.469-43.418l-234.29 234.24-94.618-94.771a30.72 30.72 0 00-43.47 43.418l116.378 116.377a30.72 30.72 0 0021.71 9.165 30.72 30.72 0 0021.76-9.011z",fill:"#3bb37d"})):h("svg",{class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38"},h("path",{d:"M512 942.08A430.08 430.08 0 11942.08 512 430.54 430.54 0 01512 942.08zm0-798.72A368.64 368.64 0 10880.64 512 369.05 369.05 0 00512 143.36zM542.72 512V352.256a30.72 30.72 0 00-61.44 0V512a30.72 30.72 0 0061.44 0zm.41 159.744a30.72 30.72 0 00-30.72-30.72H512a30.72 30.72 0 00-30.72 30.72 30.72 30.72 0 0061.44 0z",fill:"#d4ad59"})),h("h4",null,langString(3>b?"\u626B\u7801\u6210\u529F":101==b?"\u4E8C\u7EF4\u7801\u751F\u6210\u5931\u8D25":"\u626B\u7801\u5931\u8D25"),"!"),h("p",null,3>b?langString("\u8BF7\u6839\u636E\u624B\u673A\u4E0A\u63D0\u793A\u70B9\u51FB\u786E\u8BA4\u767B\u5F55"):c||langString("\u4E8C\u7EF4\u7801\u5931\u6548\uFF0C\u8BF7\u91CD\u65B0\u5237\u65B0\u4E8C\u7EF4\u7801")),h(Button,{btnId:"updateQRcode",btnDisabled:!1,btnLoading:!1,btnText:langString("Refresh_the_QR_code"),btnClick:()=>{this.props.uploadQRcode()}})):h("div",null),h(QRCode,{id:"loginQRCode",width:"150",height:"150",url:a||""})),h("div",{className:"qrloginText"},h("div",{className:"text1"},langString("\u4F7F\u7528\u4E8C\u7EF4\u7801\u767B\u5F55")),h("div",{className:"text2",dangerouslySetInnerHTML:{__html:langString("\u4F7F\u7528%s\u626B\u63CF\u4E8C\u7EF4\u7801").replace("%s",`<a class="_green" href="/mobileapp">${langString("Gate\u624B\u673AApp")}</a>`)}})))}}class Tip extends React.Component{constructor(a){super(a),this.state={}}componentDidMount(){}render(){let{msg:a,top:b,left:c,bottom:d,right:e,borderColor:g,textColor:i,direction:j,animateClass:k}=this.props;return h("div",{className:["login-tipMsg",k||""].join(" "),style:{top:b?b:"auto",bottom:d?d:"auto",left:c?c:"auto",right:e?e:"auto",borderColor:g||"transparent",borderRadius:"3px"}},h("div",{className:"login-tipMsg-por"},h("span",{className:"login-tipMsg-text",style:{color:i||"inherit"}},a),h("span",{className:["login-tipMsg-arror",j].join(" "),style:{borderColor:g||"transparent"}})))}}class TooMany extends React.Component{constructor(a){super(a),this.langString=a=>langMap[a]?langMap[a]:lang_string(a),this.init=()=>{(function(a){window.setInterval(function(){var b=0,c=0,d=0,e=0;0<a&&(b=Math.floor(a/86400),c=Math.floor(a/3600)-24*b,d=Math.floor(a/60)-60*(24*b)-60*c,e=Math.floor(a)-60*(60*(24*b))-60*(60*c)-60*d),9>=d&&(d="0"+d),9>=e&&(e="0"+e),0<parseInt(d+e)?($("#minute_show").html("<s></s>"+d),$("#second_show").html("<s></s>"+e)):window.location.href="/login",a--},1e3)})(300)},this.state={}}componentDidMount(){this.init()}render(){return h("div",{className:"too-many-con",style:{height:"100%",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},h("h1",{className:"red",style:{fontWeight:"normal",lineHeight:"50px"}},langString("TooAttempts")),h("h1",{style:{fontWeight:"normal",lineHeight:"50px"}},langString("PleaseTryAgain"),is_cn?"":" ",h("strong",{id:"minute_show"},"05"),langString("minute"),is_cn?"":" ",h("strong",{id:"second_show"},"00"),langString("second")))}}class Login extends React.Component{constructor(a){super(a),this.initLoginViewSize=()=>{is_phone||$(".maichu").css({height:`${$(".maichu").height()}px`})},this.getTitleHostTip=()=>h("div",{className:"",style:{marginTop:"15px",textAlign:is_phone?"center":"initial"}},h("span",{className:"visiting_link_text"},langString("SureVisiting")),h("h6",{className:"visiting_link"},h("span",{style:{verticalAlign:"text-bottom"}},h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-10 0 51 44",width:"30",height:"26"},h("g",{"fill-rule":"evenodd","clip-rule":"evenodd"},h("path",{d:"M25.4 13.5c-1.2 0-2.3.5-3.1 1.4-.8.9-1.1 1.9-.9 3.1h8c.2-1.2-.2-2.2-1-3.1-.6-.9-1.8-1.4-3-1.4zm7 19.5H18.6c-1.3 0-2.1-1.6-2.1-2.9v-9.5c0-.6.3-1.3.7-1.7.4-.4 1.1-.7 1.7-.7 0-.2-.1-.4-.1-.6 0-3.6 2.9-6.5 6.6-6.5 3.6 0 6.6 2.9 6.6 6.5 0 .2 0 .4-.1.6h.1c1.3 0 2.4 1.1 2.4 2.4V30c0 1.3-1.1 2.4-2.4 2.4l.4.6z",fill:"#26999e"}),h("path",{d:"M23.5 23c0 .7.4 1.4 1 1.7V30h2v-5.3c.6-.4 1-1 1-1.7 0-1.1-.9-2-2-2s-2 .9-2 2z",fill:"#002b29"}))),h("span",{id:"this_link"},h("span",{className:"text-https"},"https://"),setData.hostname)))),this.getPasswordLoginEle=()=>{let{username:a,password:b,iprestriction:c,inputOption:d,fingerprint:e,geetest_challenge:g,geetest_seccode:i,geetest_validate:j,btnDisabled:k,btnLoading:l}=this.state;return h("div",null,h("div",{className:"m_con rightlogin clearfix"},h("form",{role:"form",id:"loginForm",name:"login",method:"post",action:`https://${setData.hostname}/login`,style:{marginBottom:"5px"}},h("input",{type:"hidden",name:"fingerprint",value:e}),h("input",{type:"hidden",name:"geetest_challenge",value:g}),h("input",{type:"hidden",name:"geetest_seccode",value:i}),h("input",{type:"hidden",name:"geetest_validate",value:j}),h(InputRow,{label:d.username.label,value:a,inputName:d.username.inputName,inputType:d.username.inputType,inputId:d.username.inputId,required:d.username.required,check:a=>this.loginUsernameCheck(a),onChange:a=>{this.setState({username:a})}}),h(InputRow,{label:d.password.label,value:b,inputName:d.password.inputName,inputType:d.password.inputType,inputId:d.password.inputId,required:d.password.required,check:a=>this.loginPasswordCheck(a),onChange:a=>{this.setState({password:a})},showPsd:!0}),h("div",{className:"login_row_pad securityOptions_row",style:{minHeight:"18px"}},h("div",{className:"securityOptions_label"},h("label",{className:"haschecked pull-left tip_box securityOptions"},h("input",{className:"form-control",type:"checkbox",name:"iprestriction",id:"iprestriction",value:c?"1":"0",onChange:()=>{this.setState({iprestriction:!this.state.iprestriction})},defaultChecked:c})," ",langString("bindIP"),"(",langString("SecurityOption"),")",h("span",{className:"tip_span",style:{minWidth:"260px"}},langString("accountSafety"),"!"))),h("div",{className:"",style:window.is_ru?{width:"100%"}:{}},h("a",{className:"repsw",href:"/resetpw",className:"_green"},langString("ForgotPassword"),"?"))),h(Button,{style:{marginTop:"15px"},btnId:"loginSub",btnDisabled:k,btnLoading:l,btnText:langString("userLoginIn"),btnClick:()=>{this.sub()}}),h("span",{className:"errmsg",id:"errmsg"}))),h("div",{className:"link-to"},h("span",null,langString("NotGateUser"),"\uFF1F"),h("a",{href:"/signup",className:`_green`},langString("FreeReg"))))},this.getQRcodeLoginEle=()=>{let{iprestriction:a,inputOption:b,QRtoken:c,QRurl:d,qrCodeStatus:e,qrMsg:g}=this.state;return h("div",{className:"qrcode-login-view",style:{flex:3}},h("div",{className:"qrcode-login-content",style:{paddingLeft:"50px"}},h(LoginQRCode,{initQRcode:()=>{this.initQRcode()},QRtoken:c,QRurl:d,qrCodeStatus:e,uploadQRcode:()=>{this.uploadQRcode()},qrMsg:g})))},this.getBottomView=()=>is_phone?h("div",{className:"login_bottom_view"},h("div",{className:"app-tip tip_app login_tip"},h("a",{id:"appLink",className:"appLink",href:`${setData.lang_prefix}/mobileapp`},h("div",{className:"logo_img_box"},h("img",{src:"/images/icon64.png",alt:"gate.io APP"})),h("span",{className:"ads"},h("p",null,langString("GateAPP")),langString("DigitalAsset"))),h("div",{className:"dn-box"},h("a",{className:"dn-btn",href:`${setData.lang_prefix}/mobileapp`},langString("DowNLOADNOW"))))):h(f,null,h("div",{className:"login_bottom_view"},h(QRCode,{id:"login_download_app",class:"download_app",width:"70",height:"70",url:decodeURIComponent(`${window.location.origin}/mobileapp/download?appLang=${g_lang}`)}),h("div",{className:"flex-1"},h("p",null,langString("loginWecomeMsg")),h("a",{href:"/mobileapp"},langString("DownloadAPP"))),h("img",{className:"bg_img",src:"/images/login_download_bg.svg"}))),this.onKeyDown=a=>{13==a.keyCode&&$("#loginSub").click()},this.checkLen=a=>0<a.length,this.loginUsernameCheck=a=>!this.checkLen(a)&&this.state.inputOption.username.required?{result:!1,msg:langString("\u8BF7\u8F93\u5165\u60A8\u7684\u624B\u673A\u53F7\u7801/\u90AE\u7BB1/\u7528\u6237\u540D\uFF01"),rowStatus:"has-error"}:this.checkLen(a)?{result:!0,msg:"",rowStatus:"has-success"}:void 0,this.loginPasswordCheck=a=>this.checkLen(a)&&6>a.length?{result:!1,msg:langString("\u767B\u5F55\u5BC6\u7801\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01"),rowStatus:"has-error"}:this.checkLen(a)?{result:!0,msg:"",rowStatus:"has-success"}:{result:!1,msg:langString("\u8BF7\u8F93\u5165\u60A8\u7684\u767B\u5F55\u5BC6\u7801\uFF01"),rowStatus:"has-error"},this.checkParams=()=>this.loginUsernameCheck(this.state.username).result?!!this.loginPasswordCheck(this.state.password).result||($("#password").focus().blur(),!1):($("#email").focus().blur(),!1),this.getPToken=()=>{let a="",b=getRandChars(16),c=Date.parse(new Date),d=new Fingerprint({canvas:!0});return a=md5.hex(d.get().toString()+c+b),a},this.loopQueryStatus=()=>{let a=this;null!=this.timer&&this.stopQueryStatus(),this.timer=setInterval(()=>null==a.timer?(a.stopQueryStatus(),!1):void a.queryStatus(),this.state.queryLoopTime)},this.stopQueryStatus=()=>(null!=this.timer&&(clearInterval(this.timer),this.timer=null),!1),this.uploadQRcode=()=>{this.initQRcode()},this.queryStatus=()=>{let{pToken:a,QRtoken:b}=this.state,c=this;if(!b)return c.stopQueryStatus(),!1;$.ajax({url:"/json_svr/qrlogin",type:"post",data:{p_token:a,qrtoken:b},success:a=>{if(0!=a.code)return c.stopQueryStatus(),noty({text:a.msg,theme:"gateioNotyTheme",type:"warning",layout:"bottomLeft",timeout:1e4}),!1;if(a.status){let d=+a.status;if(0!=d&&c.setState({qrCodeStatus:d}),2==d){c.stopQueryStatus();var b=a.lasturl;if(-1!==b.indexOf("marketlist")){const a="1"===localStorage.getItem("is_market_list_race");a&&(b+="?race=1&tab=usdt")}return location.href=b,!1}if(4==d&&c.setState({qrMsg:a.msg}),1<d)return c.stopQueryStatus(),!1}},error:a=>{console.log(a)}})},this.initQRcode=()=>{let a=this;$.ajax({url:"/json_svr/generateqr",type:"post",data:{p_token:this.state.pToken},success:b=>{0==b.code?a.setState({QRtoken:b.qrtoken||"",QRurl:b.qr||"",qrCodeStatus:0,qrMsg:""},()=>{a.loopQueryStatus()}):a.setState({QRtoken:"",QRurl:"",qrCodeStatus:101,qrMsg:b.msg})},error:()=>{}})},this.initGtCaptcha=a=>{let b=this;initCaptcha({bindForm:"#loginForm",scene:"login",onReady:a=>{a&&a.verify()},onSuccess:c=>{b.setState(_objectSpread({},c.result),()=>{a()})},onError:()=>{b.setState({btnLoading:!1,btnDisabled:!1})},onClose:()=>{b.setState({btnLoading:!1,btnDisabled:!1})}})},this.sub=()=>{if(!this.checkParams())return!1;let a=this;this.setState({btnLoading:!0,btnDisabled:!0},()=>{this.initGtCaptcha(()=>{a.postParams()})})},this.postParams=()=>{$("#loginForm").submit()},this.state={username:setData.showEmailVerifyDialog?setData.signed_nickname:setData.email||"",password:"",iprestriction:!0,tooMany:!1,pToken:"",QRtoken:"",QRurl:"",qrCodeStatus:0,qrMsg:"",fingerprint:"",geetest_challenge:"",geetest_seccode:"",geetest_validate:"",queryLoopTime:3e3,btnLoading:!1,btnDisabled:!1,inputOption:{username:{label:`${langString("PhoneNumberSmsSetup")}/${langString("Email")}/${langString("RegUsername")}`,inputName:"email",inputType:"text",inputId:"email",required:!0},password:{label:langString("userPwd"),inputName:"password",inputType:"password",inputId:"password",required:!0}}}}componentWillMount(){this.setState({tooMany:!!setData.tooMany,pToken:this.getPToken()})}componentDidMount(){this.initLoginViewSize(),document.addEventListener("keydown",this.onKeyDown),this.timer=null}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown),null!=this.timer&&this.stopQueryStatus(),this.timer=null}render(){let{tooMany:a,qrCodeStatus:b}=this.state;return h("div",{className:"left_con_login",style:a?tooManyViewStyle:{}},a?h(TooMany,null):h("div",{className:"login_incontent login-con",style:is_phone?{}:{display:"flex",flexDirection:"row"}},h("div",{className:"right_mcontent clearfix"},h("div",{className:"maichu",style:{marginTop:0,display:"flex",flexDirection:"column",width:is_phone?"100%":"600px"}},window.is_ru&&h("div",{className:"m_title"},h("h4",{style:{textAlign:"left"}},langString("Login")," Gate.io"),this.getTitleHostTip()),h("div",{style:{display:"flex",direction:"row"}},h("div",{style:{display:"flex",flexDirection:"column",flex:4}},!window.is_ru&&h("div",{className:"m_title"},h("h4",{style:{textAlign:"left"}},window.is_it?langString("\u767B\u5F55_a"):langString("Login")," Gate.io"),this.getTitleHostTip()),this.getPasswordLoginEle()),!is_phone&&this.getQRcodeLoginEle())),this.getBottomView())))}}ReactDOM.render(h(Login,null),get_element("login"));