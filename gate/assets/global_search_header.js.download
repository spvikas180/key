!async function(){function a(){function a(a){$("#globalSearchHeaderArea .search-header-placeholder-container").html("");let b=JSON.parse(localStorage.getItem("globalSearchHistory")||"[]"),c=`
          ${0===b.length?"":`<div class='search-list-title search-history-title'><span>${searchHistoryLanguage}</span><span class='clear-search-history'>${lang_string("\u6E05\u9664")}</span></div>`}
          <div class='search-history-container'>${b.map((a,b)=>10>b?`<span class='search-history-item' data-history='${a}'>${a}</span>`:"").join("")}</div>
          <div class='search-list-title'>${hotSearchRankLanguage}<span class='search-hot-rank'><span style='transform: scale(0.83)'>HOT</span></span></div>
          <div class='hot-list-container'>${a.map(a=>`
          <div class='hot-rank-item' data-pair='${a.coin.toUpperCase()}'>
            <span class='global-search-coin-icon' style='background-image: url("/images/coin_icon/64/${a.coin.toLowerCase()}.png")'></span>
            <span class='hot-rank-item-name'>${a.coin}</span>
            <span class='hot-rank-item-rate ${0<+a.change?"red":"green"}'>${(0<+a.change?"+":"")+a.change}%</span>
            <span class='global-search-market-ranking'>
              <span>#${a.marketcap_rank}</span>
              <div class='global-search-market-ranking-hit'>${lang_string("\u5E02\u503C\u6392\u540D")} #${a.marketcap_rank}</div>
            </span>
          </div>`).join("")}</div>
          <div class='search-more-container'><span class='search-more'>${lang_string("\u67E5\u770B\u66F4\u591A")} ></span></div>
      `;$("#globalSearchHeaderArea .search-header-placeholder-container").html(c),$("#globalSearchHeaderArea .clear-search-history").on("click",function(){localStorage.setItem("globalSearchHistory","[]"),$("#globalSearchHeaderArea .search-history-container").html(""),$("#globalSearchHeaderArea .search-history-title").hide()}),$("#globalSearchHeaderArea .search-more").on("click",function(){var a="/trade/";1==$.cookie("tradeIsDefaultProtrade")&&(a="/tradepro/btc_usdt"),location.href=a}),$("#globalSearchHeaderArea .hot-rank-item").on("click",function(){const a=$(this).attr("data-pair");let b=JSON.parse(localStorage.getItem("globalSearchHistory")||"[]");-1===b.indexOf(a)&&(b.unshift(a),localStorage.setItem("globalSearchHistory",JSON.stringify(b)));var c=`/trade/${a}_USDT`;1==$.cookie("tradeIsDefaultProtrade")&&(c=`/tradepro/${a}_USDT`),location.href=c}),$("#globalSearchHeaderArea .search-history-item").on("click",function(){const a=$(this).attr("data-history"),b=filterXSS(a,1);$("#global-search-header-input").val(b),$("#global-search-header-input").trigger("propertychange")})}var c=$("#global-search-header-input"),d=$(".global-search-header-list"),e=$(".global-search-header .global-search-header-select-dropdown"),f=!1;c.attr("placeholder",lang_string("\u641C\u7D22")),c.on("input propertychange",function(){f||b(this);const a=filterXSS($("#global-search-header-input").val(),1);1<a.length?$(".global-search-header-placeholder-view").hide():($(".global-search-header-select-dropdown").hide(),$(".global-search-header-placeholder-view").show()),j=0}).on("compositionstart",function(){f=!0}).on("compositionend",function(){f=!1,f||b(this),j=0}),function(){$.ajax({type:"post",url:"/json_svr/query?u=23",data:{type:"get_hot_market_pairs"},success:function(b){b&&(PubSub.publish("DRAW_GLOBAL_SEARCH_PLACEHOLDER",b),a(b))},error:function(a){console.log(a)}})}(),d.on("click","p",function(){if(!$(this).hasClass("no-search-data")){var a=$(this).attr("data-href"),b=$(this).attr("data-type");let d=JSON.parse(localStorage.getItem("globalSearchHistory")||"[]");const e=filterXSS($("#global-search-header-input").val(),1);if(-1===d.indexOf(e)&&(d.unshift(e),localStorage.setItem("globalSearchHistory",JSON.stringify(d))),"spot"===b&&1==$.cookie("tradeIsDefaultProtrade")){var c=$(this).attr("data-pair");a="/tradepro/"+c}a&&(location.href=a)}}),$(document).on("mousedown",function(a){var b=$("#globalSearchHeaderArea");b.is(a.target)||0!==b.has(a.target).length||(d.html(""),$("#globalSearchHeaderArea .global-search-header-select-dropdown").hide(),$("#globalSearchHeaderArea .global-search-header-placeholder-view").show(),c.val(""))})}function b(a){$(a).val(filterXSS($(a).val(),1));var b=filterXSS(a.value.toUpperCase(),1);if(2>b.length)return $(".global-search-header .global-search-header-select-dropdown").hide(),$(".global-search-header .global-search-header-placeholder-view").show(),!1;if(!window.global_search_data||{}===window.global_search_data)return e(),!1;let d={},f=!0;Object.keys(window.global_search_data).forEach(a=>{var c=window.global_search_data[a],e=[],g=[],h=[];if(c.map(a=>{var c=a.name.split("_")[0].toUpperCase();c===b?e.push(a):-1<c.indexOf(b)&&g.push(a)}),"spot"===a||"etf"===a||"contract"===a){const b=[...e,...g,...h];0!==b.length&&(d[a]=b,f=!1)}else{const b=[...e,...g,...h];0!==b.length&&(!d.finance&&(d.finance={}),d.finance[a]=b,f=!1)}}),b?f?e():c(d,b):($(".global-search-header-list").html(""),$(".global-search-header .global-search-header-select-dropdown").hide()),d=null}function c(a,b){var c="",e=localStorage.getItem("custom")||"",f=e.toLowerCase().split(",");let g=localStorage.getItem("favor-contracts")||"[]",h=JSON.parse(g.toLowerCase());const i={spot:spotLanguage,etf:"ETF",contract:contractLanguage,finance:financeLanguage,borrow:marginTenderLanguage,lend:marginFinancialLanguage,liquidity:yieldFarmingLanguage,mortgage:cryptoLoanLanguage};Object.keys(a).forEach(e=>{const g=a[e];c+=`<div class='search-list-title'>${i[e]}</div>`,c+="finance"===e?`<div class='search-finance-container'>${Object.keys(g).map(a=>{const c=g[a];return`
            <div class='search-finance-list-container'>
              <div class='search-list-second-title'>${lang_string(i[a])}</div>
              ${c.map(a=>`<p class='' data-href='${a.href}' data-type='${a.type}' data-pair='${a.name.toUpperCase()}'>
                        ${d(a.name,b)}
                      </p>`).join("")}
            </div>
          `}).join("")}</div>`:`<div class='search-list-item-container'>
      ${g.map(a=>`<p data-href='${a.href}' data-type='${a.type}' data-pair='${a.name.toUpperCase()}'>
              ${d(a.name,b)}
              ${"contract"==a.type?``:`<span class='fav_icon pull-right search_fav ${-1<f.indexOf(a.name.toLowerCase())?"custom-on":""}' data-type='${a.type}' data-id='${a.name.toLowerCase()}' title='${lang_string(-1<f.indexOf(a.name.toLowerCase())?"\u53D6\u6D88\u81EA\u9009":"\u52A0\u81EA\u9009")}'></span>`}
              ${"contract"===a.type?`<span class='fav_icon pull-right search_fav ${-1<h.indexOf(a.name.toLowerCase())?"custom-on":""}' data-type='${a.type}' data-id='${a.name.toLowerCase()}' title='${lang_string(-1<f.indexOf(a.name.toLowerCase())?"\u53D6\u6D88\u81EA\u9009":"\u52A0\u81EA\u9009")}'></span>`:``}
            </p>`).join("")}
        </div>`}),$(".global-search-header-list").html(c),$(".global-search-header .global-search-header-select-dropdown").show()}function d(a,b){var c=a.toUpperCase().split("_");1<c.length&&(c=[c[0],"_",c[1]]);const d=`${c[0].replace(new RegExp(b.toUpperCase()),`<span class='search_needle'>${b.toUpperCase()}</span>`)}`;return c[0]=d,`<span>${c.join("")}</span>`}function e(){$(".global-search-header-list").html("<div class=\"noorder\"></div><div class=\"no-search-data\">"+lang_string("\u6682\u65E0\u6570\u636E")+"</div>"),$(".global-search-header .global-search-header-select-dropdown").show()}function f(a){var b=a.attr("data-type"),c=a.attr("data-id");if("contract"===b){let a=JSON.parse(localStorage.getItem("favor-contracts"))||[];a=[c].concat(a),localStorage.setItem("favor-contracts",JSON.stringify(a)),PubSub.publish("CHANGE_CONTRACT_FAV_COIN",{action:"add",pair:c})}else{var d=localStorage.getItem("custom");if(d){var e=localStorage.getItem("custom").split(",");if(-1===$.inArray(c,e)){var f=[...e,c];localStorage.setItem("custom",f)}}else localStorage.setItem("custom",c);PubSub.publish("CHANGE_SPOT_FAV_COIN",{action:"add",pair:c})}}function g(a){var b=a.attr("data-type"),d=a.attr("data-id");if("contract"===b){let a=JSON.parse(localStorage.getItem("favor-contracts"))||[];a&&(a=a.filter(a=>a!==d)),localStorage.setItem("favor-contracts",JSON.stringify(a)),PubSub.publish("CHANGE_CONTRACT_FAV_COIN",{action:"reduce",pair:d})}else{var e=localStorage.getItem("custom");if(e){var f=e.split(",");(function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b){a.splice(c,1);break}})(f,d),0===f.length?localStorage.removeItem("custom"):localStorage.setItem("custom",f)}PubSub.publish("CHANGE_SPOT_FAV_COIN",{action:"reduce",pair:d})}}await async function(){const a=localStorage.getItem("USER_LOGIN_STATUS"),b=localStorage.getItem("USER_LANGUAGE_STATUS"),c=""!==globalSearchUserId&&""!==nickName;a===c+""?b!==g_lang&&(localStorage.setItem("USER_LANGUAGE_STATUS",g_lang),await clearIndexedDBCache("global_search_data_storage")):(localStorage.setItem("USER_LOGIN_STATUS",c+""),await clearIndexedDBCache("global_search_data_storage"))}();var h=await getDataFromIndexedDB("global_search_data_storage",5);h?window.global_search_data=h:function(){function a(a,b){let c="";if("spot"==b||"etf"==b)c=`/trade/${a.toUpperCase()}`;else if("contract"==b){var d=a.split("_")[1];c="USDT"===d?`/futures_trade/USDT/${a.toUpperCase()}`:`/futures_trade/BTC/${a.toUpperCase()}`}else"margin"==b?c=`/margin_trade/${a.toUpperCase()}`:"lend"===b?c=`/margin/lend/${a.toUpperCase()}`:"mortgage"===b?c=`/cryptoloan/${a.toUpperCase()}`:"borrow"===b?c=`/margin/borrow/${a.toUpperCase()}`:"liquidity"===b&&(c=`/liquidity_add/${a.toUpperCase()}`);return c}$.ajax({type:"post",url:"/json_svr/query?u=23",data:{type:"get_all_market_pairs"},success:function(b){if(b){window.global_search_data={};for(var c=Object.keys(b),d=0;d<c.length;d++){window.global_search_data[c[d]]=[];for(var e=0;e<b[c[d]].length;e++){var f={name:b[c[d]][e].pair,href:a(b[c[d]][e].pair,c[d]),type:c[d]},g=b[c[d]][e].multiple;g&&(f.multiple=g,f.margin_href=a(b[c[d]][e].pair,"margin")),window.global_search_data[c[d]].push(f)}}addDataToIndexDB("global_search_data_storage",window.global_search_data)}},error:function(a){console.log(a)}})}(),function(){$.ajax({type:"post",url:"/json_svr/query?type=get_customer_pairs&u=29&c=336750",success:function(a){if(0===a.resMsg.code){let b=a.datas;b&&0<b.length&&localStorage.setItem("custom",b.toLowerCase())}}})}();let i,j=0,k={};$(".global-search-header-list").on("click",".fav_icon",function(a){a=window.event||a,a.stopPropagation();var b=$(this),c=b.attr("data-id"),d=$("#list_tbody");b.hasClass("custom-on")?(b.removeClass("custom-on").attr("title",lang_string("\u52A0\u81EA\u9009")),g(b)):(b.addClass("custom-on").attr("title",lang_string("\u53D6\u6D88\u81EA\u9009")),f(b)),customCookie=localStorage.getItem("custom"),void 0===k[b.attr("data-id")]?b.hasClass("custom-on")?k[b.attr("data-id")]=1:k[b.attr("data-id")]=0:delete k[b.attr("data-id")];var h=b.attr("data-type");return"contract"===h||i||(i=setTimeout(()=>{$.ajax({type:"post",url:"json_svr/query?u=29&c=336750",data:{type:"set_customer_pairs",pairs:JSON.stringify(k)},success:function(a){0===a.resMsg.code&&(i=void 0,k={})}})},3e3)),!1}),$(function(){a()})}();